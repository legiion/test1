Imports Microsoft.Win32

Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        ' Check if the registry key exists
        Dim keyExists As Boolean = My.Computer.Registry.CurrentUser.OpenSubKey("Software\MyApp") IsNot Nothing
        
        ' If the key exists and the stored password matches, close the application
        If keyExists AndAlso My.Computer.Registry.GetValue("HKEY_CURRENT_USER\Software\MyApp", "Password", "") = "K91KnMFockJT6Bzq" Then
            Me.Close()
        End If

        ' Set window properties
        Me.FormBorderStyle = FormBorderStyle.None
        Me.WindowState = FormWindowState.Maximized
        Me.BackColor = Color.Black

        ' Add text label
        Dim label As New Label()
        label.Text = "It is a test"
        label.ForeColor = Color.White
        label.AutoSize = True
        label.Location = New Point((Me.Width - label.Width) \ 2, (Me.Height - label.Height) \ 2)
        Me.Controls.Add(label)

        ' Add text input frame
        Dim textBox As New TextBox()
        textBox.Name = "TextBox1"
        textBox.Location = New Point((Me.Width - textBox.Width) \ 2, (Me.Height - textBox.Height) \ 2 + 30)
        Me.Controls.Add(textBox)

        ' Add OK button
        Dim button As New Button()
        button.Text = "OK"
        button.Location = New Point((Me.Width - button.Width) \ 2, (Me.Height - button.Height) \ 2 + 60)
        AddHandler button.Click, AddressOf OKButton_Click
        Me.Controls.Add(button)
    End Sub

    Private Sub OKButton_Click(sender As Object, e As EventArgs)
        ' Check if the entered text matches the specified password
        If TypeOf Me.Controls("TextBox1") Is TextBox Then
            Dim textBox As TextBox = CType(Me.Controls("TextBox1"), TextBox)
            If textBox.Text = "K91KnMFockJT6Bzq" Then
                ' Save the password in registry
                My.Computer.Registry.SetValue("HKEY_CURRENT_USER\Software\MyApp", "Password", "K91KnMFockJT6Bzq")
                Me.Close()
            End If
        End If
    End Sub

    Protected Overrides Sub OnFormClosing(e As FormClosingEventArgs)
        ' Check if Alt + F4 was pressed
        If e.CloseReason = CloseReason.UserClosing AndAlso Control.ModifierKeys = Keys.Alt Then
            e.Cancel = True ' Cancel the closing event
        End If

        MyBase.OnFormClosing(e)
    End Sub
End Class
